---
import Link from './Link.astro'
import { Icon } from 'astro-icon/components'
import { Image } from 'astro:assets'
import { Badge } from '@/components/ui/badge'

interface Props {
  title: string
  description?: string
  link: string
  youtubeId?: string
  image?: any
  date: Date
  language?: string
  tags?: string[]
}

const { title, description, link, youtubeId, image, date, language } = Astro.props

const formattedDate = date.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
})

const thumbnailUrl = youtubeId 
  ? `https://img.youtube.com/vi/${youtubeId}/maxresdefault.jpg`
  : null
---

<div class="group relative flex flex-col md:flex-row gap-4 rounded-xl border border-border/50 bg-card p-4 transition-colors hover:bg-accent/5">
  {thumbnailUrl || image ? (
    <a href={link} target="_blank" rel="noopener noreferrer" class="relative aspect-video md:w-2/5 shrink-0 overflow-hidden rounded-lg border border-border/50 block">
      {thumbnailUrl ? (
        <img
          src={thumbnailUrl}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      ) : (
        <Image
          src={image}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      )}
      <div class="absolute inset-0 flex items-center justify-center bg-black/20 opacity-0 transition-opacity group-hover:opacity-100">
        <Icon name="lucide:play-circle" class="size-12 text-white" />
      </div>
    </a>
  ) : null}

  <div class="flex flex-1 flex-col gap-2">
    <time datetime={date.toISOString()} class="text-xs text-muted-foreground">
      {formattedDate}
    </time>
    
    <div class="flex items-start justify-between gap-4">
      <Link href={link} external class="flex-1 group-hover:text-primary transition-colors">
        <h3 class="text-lg font-medium leading-snug flex items-center gap-x-2">
          {title}
          <Icon name="lucide:external-link" class="size-4 shrink-0 opacity-0 transition-opacity group-hover:opacity-100" />
        </h3>
      </Link>
      {language && (
        <Badge variant="theme1" className="text-[10px] px-1.5 py-0 h-5 shrink-0 mt-1">
          {language}
        </Badge>
      )}
    </div>

    {description && (
      <p class="text-sm text-muted-foreground leading-relaxed">
        {description}
      </p>
    )}
  </div>
</div>
